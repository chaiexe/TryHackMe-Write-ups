-----
**<p align="center">TryHackMe: Basic Pentesting</p>**
---

<p align="center">
  <img src="x" alt="image alt" width="180" />
</p>

[![Day 26 of 30 ‚Äì Hack Documentation Challenge](https://img.shields.io/badge/Day%2026%20of%2030-Hack%20Documentation%20Challenge-crimson?style=for-the-badge&logo=tryhackme)](https://tryhackme.com)

**Topic:** Web application pentesting

Completed: 8/8/2025

‚ÄúThis is a machine that allows you to practise web app hacking and privilege escalation.‚Äú

‚ÄúIn these set of tasks you'll learn the following:
- brute forcing 
- hash cracking 
- service enumeration
- Linux Enumeration‚Äù

<p align="center">+++++++++</p>

Starting off with an `Nmap -sV -sC` scan revealed 6 open TCP ports:
```
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        Apache httpd 2.4.41 ((Ubuntu))
139/tcp  open  netbios-ssn Samba smbd 4.6.2
445/tcp  open  netbios-ssn Samba smbd 4.6.2
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8080/tcp open  http        Apache Tomcat 9.0.7
```

*I made a mental note of the http service running on port 8080 hosting Apache Tomcat version 9.0.7*.

Navigating to `http://10.201.48.211:80` brought up a minimal ‚ÄúUnder Maintenance‚Äù page. I then checked `http://10.201.48.211:8080` and confirmed that Tomcat was accessible.

![Alt text](1)

I ran Gobuster to enumerate directories on the web server:
```
gobuster dir -u http://10.201.48.211 -w /usr/share/wordlists/dirb/common.txt
```

This revealed a `/development` directory. Visiting it displayed an index listing containing two `.txt` files.

![Alt text](2)

Using the `wget` command to download each of the files allowed me to further investigate their contents from my local machine.

It appeared to be a few messages shared between two people, (J and K) that included some interesting details:

- User K played with **Apache Struts** (specifically v2.5.12).
- A REST-based demo was hosted.
- SMB was configured.
- Apache was set up.
- K cracked J‚Äôs password from `/etc/shadow`. That implies weak password hash stored locally

![Alt text](3)

I checked `/manager/html` on port 8080, but it prompted for credentials I did not yet have.
Clicking ‚ÄúCancel‚Äù returned a 401 Unauthorized page.
At this stage, I decided to pivot to the SMB service, guided in part by a TryHackMe hint suggesting that SMB enumeration might reveal a username.

![Alt text](4)

![Alt text](5)

I began investigating the SMB service discovered during the initial Nmap scan. First, I listed available shares using:
```
smbclient -L \\10.201.48.211\\ -N
```
This revealed an anonymous share accessible without authentication. Connecting to it:
```
smbclient \\\\10.201.48.211\\anonymous -N
```

Inside, I found a file named `staff.txt` and downloaded it with:
```
get staff.txt
```

![Alt text](6)

Opening `staff.txt` revealed two potential usernames:
- Jan
- Kay

![Alt text](7)

I first created a text file containing both potential usernames (`jan` and `kay`) to test against the `/manager/html` login on port 8080 using Hydra. The command was:
```
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt http-get://10.201.48.211:8080/manager/html
```
However, this approach returned too many potential matches to be useful.

To refine my search, I tested each username in TryHackMe‚Äôs answer field. This confirmed that the correct target username was `jan`.

With that confirmed, I moved on to brute-forcing only Jan‚Äôs SSH credentials.

![Alt text](8)

With the username confirmed, I used **Hydra** to attempt a password brute-force against the SSH service:
```
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.201.48.211
```

Hydra successfully identified Jan‚Äôs password.


![Alt text](9)


Using the discovered credentials, I was able to log into Jan‚Äôs account:
```
ssh jan@10.201.48.211
```

![Alt text](10)

The sign in brought me to jan‚Äôs home directory. I began enumerating other potential user accounts. Running:
```
cat /etc/passwd | grep "/home"
```
listed the accounts with home directories:
- syslog
- kay
- tomcat9
- jan

![Alt text](11)

Next, I checked Jan‚Äôs `sudo` privileges:
```
sudo -l
```

This revealed that Jan had no sudo permissions on the server. Since privilege escalation through sudo was off the table, I turned to searching for SUID binaries that might be exploitable:
```
find / -perm -4000 -type f 2>/dev/null
```

![Alt text](12)

To perform a more thorough enumeration, I decided to run **LinPEAS**, a Linux privilege escalation script. I first downloaded it locally:

```curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh -o linpeas.sh
chmod +x linpeas. sh
./linpeas.sh
```

![Alt text](13)

Knowing Jan‚Äôs SSH password, I transferred LinPEAS to the target machine‚Äôs `/tmp` directory:
```
scp linpeas.sh jan@10.201.48.211:/tmp
```

![Alt text](14)

Back on the target machine, I verified that `linpeas.sh` was present in the `/tmp` directory. I made it executable with:
```
chmod +x linpeas.sh
```

Then, I ran the script and saved the output to a log file using:
```
./linpeas.sh | tee linlog.txt
```

![Alt text](15)

The LinPEAS scan uncovered an abundance of information, including a private SSH RSA key belonging to the user `kay`.

![Alt text](16)

I copied the key‚Äôs contents and saved it locally to a file named `kay_private_rsa`.

![Alt text](17)

To protect the key‚Äôs confidentiality, I changed its permissions to `600`, which restricts access so only the file owner can read and write it.

Next, I used the tool **ssh2john** to convert the RSA private key into a hash format suitable for password cracking with **John the Ripper**. The output was saved to a file named `forjohn.txt`.

<p align="center">+++++++++</p>

<p align="center">‚ú®Research Deep-Dive‚ú®</p>

**About:** `chmod 600`

Changing the file permissions to `600` means that only the file‚Äôs owner has read and write access, while all others have no permissions. This is crucial for protecting sensitive files like private keys, ensuring that no other users on the system can read or modify them.

<p align="center">+</p>

**About: ssh2john**

The tool **ssh2john** is part of the John the Ripper suite and is used to convert SSH private key files into a hash format that John can attempt to crack. Since private keys are often encrypted with a passphrase, ssh2john extracts this encrypted portion into a format suitable for password cracking. This allows John the Ripper to test passphrase guesses against the private key, ultimately revealing the passphrase if it‚Äôs weak enough.

<p align="center">+++++++++</p>

![Alt text](18)

Using the `forjohn.txt` file containing the extracted hash, I ran **John the Ripper** to crack Kay‚Äôs RSA private key password.

I initially encountered an issue because John was not located in the default PATH environment variable. To fix this, 
I specified the full path to the executable:
```
sudo /usr/sbin/john --wordlist=/usr/share/wordlists/rockyou.txt forjohn.txt
```

However, another error occurred:
```
Crash recovery file is locked: /root/.john/john.rec
```

To resolve this, I deleted the recovery file with:
```
rm ~/.john/john.rec
```

This allowed John to run successfully and crack Kay‚Äôs password.

![Alt text](19)

Next, I attempted to SSH into Kay‚Äôs account using the cracked private key but received the error:
```
Load key "kay_private_rsa": error in libcrypto
```

![Alt text](20)

To fix this, I returned to the original RSA private key on the target machine and recopied it into a new `.txt` file. I modified the file permissions again using `chmod 600` to protect the key‚Äôs confidentiality.

Finally, I used the corrected key with the command:
```
ssh -i kay_new_rsa kay@10.201.48.211
```

and entered the cracked password, successfully gaining access to Kay‚Äôs account.

![Alt text](21)

After successfully gaining access to Kay‚Äôs account, I located and viewed the file `pass.bak`, which contained the final flag of the room, marking the completion of the challenge.

![Alt text](22)

<p align="center">+++++++++</p>

<p align="center">‚ú®Research Deep-Dive‚ú®</p>

A `.bak` file is simply a backup copy of another file. The `.bak` extension usually indicates that the file is a saved backup, often automatically created by software or manually by users to preserve a previous version before making changes.

In pentesting or hacking labs, `.bak` files can be gold mines because they might contain sensitive info, configs, or even passwords that were ‚Äúbacked up‚Äù but forgotten or left exposed.

<p align="center">+++++++++</p>

**Lesson‚Äôs Learned**

This box was a fantastic experience that reinforced several essential pentesting skills. I enjoyed exploring multiple service enumeration techniques, especially leveraging SMB shares to uncover usernames. The process of cracking SSH credentials and handling private keys deepened my understanding of real-world attack paths.

I particularly appreciated how the challenge encouraged pivoting between web and SMB services, reminding me to think creatively and adapt my approach when stuck. Overall, this box boosted my confidence in using tools like Nmap, Gobuster, Hydra, and LinPEAS, and sharpened my privilege escalation mindset.

I really loved this box, it was challenging, rewarding, and fun!

<p align="center">+++++++++</p>

üîí Out of respect for the learning experience, I‚Äôve chosen not to share the flag answers directly. Instead, I‚Äôve documented my full process to support both others and myself in understanding the vulnerability.

**Resources**:
- [TryHackMe's Basic Pentesting Room](https://tryhackme.com/room/basicpentestingjt)
